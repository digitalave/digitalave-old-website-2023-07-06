I"2<h1 id="setup-remote-vpn-access-using-pfsense-and-openvpn">Setup Remote VPN Access Using PfSense and OpenVPN</h1>

<style>.embed-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; } .embed-container iframe, .embed-container object, .embed-container embed { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }</style>
<div class="embed-container"><iframe src="https://www.youtube.com/embed/hqjE4KySvWU" frameborder="0" allowfullscreen=""></iframe></div>

<p>Pfsense is a great firewall solution. Very reliable and comes with built in VLAN and VPN support. In this tutorial I’m going to demonstrate how to setup a user authenticated OpenVPN server in PfSense.
In this guide I assume you already have a functional pfSense firewall running.</p>

<h2 id="step-1---open-openvpn-wizard">STEP 1: - Open OpenVPN Wizard</h2>

<p>A. Create a Virtual Machine for Pfsense</p>

<p><img src="/images/pages/pf-vpn/image001_N.jpg" width="100%" /></p>

<p><img src="/images/pages/pf-vpn/image002_N.jpg" width="100%" /></p>

<p>Select OpenVPN Authentication Backed Type</p>

<p><img src="/images/pages/pf-vpn/image003_N.jpg" width="100%" /></p>

<p>In this tutorial I have used “Local User Access” as the authenticated backed type.</p>

<h2 id="step-2--create-new-ca">STEP 2:- Create New CA</h2>

<p>Create a Certificate Authority to generate certificates for the OpenVPN server.</p>

<p>Fill out the following fields to create a new CA.</p>

<p><img src="/images/pages/pf-vpn/image004_N.jpg" width="100%" /></p>

<h2 id="step-3--create-server-certificate">STEP 3:- Create Server Certificate</h2>

<p>Create a Server Certificate from the CA for OpenVPN.</p>

<p><img src="/images/pages/pf-vpn/image005_N.jpg" width="100%" /></p>

<h2 id="step-4--openvpn-genaral-settings-configuration">STEP 4:- OpenVPN Genaral Settings Configuration</h2>

<p>In this case OpenVPN interface will listen on external facing WAN interface which is connected to the internet.</p>

<p>Interface: WAN</p>

<p>Protocol: UDP on IPv4 Only</p>

<p>LocalPort: 1194</p>

<p>Description: VPN</p>

<p><img src="/images/pages/pf-vpn/image006_N.jpg" width="100%" /></p>

<p>Cryptographic Settings Configuration</p>

<p>This section can be left default or change it upon your security needs.</p>

<p><img src="/images/pages/pf-vpn/image007.png" width="100%" /></p>

<h2 id="step-5--openvpn-tunnel-configuration">STEP 5:- OpenVPN Tunnel Configuration</h2>

<p>There are two important sections.</p>

<p>Tunnel Network</p>

<p>The tunnel networl should be a new network that does not currently exist on the network or the Pfsense firewall routing table.</p>

<p>When client connect to the VPN they will receive an address in this network.</p>

<p>Ex: 172.25.0.10/24</p>

<p>Local Network</p>

<p>Enter the network address of that client will connect to local network. Network address that Pfsense box resides.</p>

<p>Rest of the settings can be change according to your requirement.</p>

<p><img src="/images/pages/pf-vpn/image008.png" width="100%" /></p>

<h2 id="step-6--openvpn-client-settings">STEP 6:- OpenVPN Client Settings</h2>

<p>The settings in the client settings section will be assigned to OpenVPN clients when they connect to the network.</p>

<p>If you are also using pfSense as your local DNS server, you would enter them here. Separate DNS servers also can enter here.</p>

<p>Optionally DNS, NTP server can be provided to the VPN clients from here.</p>

<p><img src="/images/pages/pf-vpn/image009.png" width="100%" /></p>

<p><img src="/images/pages/pf-vpn/image010.png" width="100%" /></p>

<h2 id="step-7--firewall-rule-creation-for-opnvpn">STEP 7:- Firewall Rule creation for OpnVPN</h2>

<p>Traffic from client to server: - If this section enabled, OpenVPN wizard will automatically generate the necessary firewall rules to permit the incoming connection to Pfsense OpenVPN server from clients anywhere on the internet.</p>

<p>Traffic from clients through VPN:- If this connection enabled, OpenVPN wizard will automatically generate firewall rules which allow traffic from clients connected to the VPN to anywhere on the local network.</p>

<p><img src="/images/pages/pf-vpn/image011.png" width="100%" /></p>

<p>Finally finish the wizard.</p>

<p><img src="/images/pages/pf-vpn/image012.png" width="100%" /></p>

<h2 id="step-8--create-vpn-users-with-certificates">STEP 8:- Create VPN Users with Certificates</h2>

<p>If you selected the “local user access” option during the VPN wizard then users can be added through the pfSense user manger.</p>

<p><img src="/images/pages/pf-vpn/image013_N.jpg" width="100%" /></p>

<p>Create new user.</p>

<p><img src="/images/pages/pf-vpn/image014.png" width="100%" /></p>

<p><img src="/images/pages/pf-vpn/image015.png" width="100%" /></p>

<p><img src="/images/pages/pf-vpn/image016.png" width="100%" /></p>

<h2 id="step-9--install-opnvpn-client-export-package">STEP 9:- Install OpnVPN Client Export Package</h2>

<p>Install OpenVPN Client Export package using Pfsense package manager.</p>

<p><img src="/images/pages/pf-vpn/image017_N.jpg" width="100%" /></p>

<p><img src="/images/pages/pf-vpn/image018.png" width="100%" /></p>

<p><img src="/images/pages/pf-vpn/image019_N.jpg" width="100%" /></p>

<p>After the installation there will be a new tab named with “Client Export” in OpenVPN menu.</p>

<p><img src="/images/pages/pf-vpn/image020.png" width="100%" /></p>

<p>Modify “Hostname Resolution” field. By default this is set to the IP address of the interface running OpenVPN.</p>

<p><img src="/images/pages/pf-vpn/image021.png" width="100%" /></p>

<p><img src="/images/pages/pf-vpn/image022.png" width="100%" /></p>

<p>After any changes made, click the “Save as default” button to store the settings.</p>

<h2 id="step-10--download-the-openvpn-client-packages">STEP 10:- Download the OpenVPN Client Packages.</h2>

<p><img src="/images/pages/pf-vpn/image023.png" width="100%" /></p>

<p>Download and install OpenVPN client application.</p>

<blockquote>
  <p>https://openvpn.net/index.php/open-source/downloads.html</p>

  <p>https://swupdate.openvpn.org/community/releases/openvpn-install-2.4.6-I602.exe</p>
</blockquote>

<p>Install downloaded OpenVPN profile.</p>

<p><img src="/images/pages/pf-vpn/image024_N.jpg" width="100%" /></p>

<p><img src="/images/pages/pf-vpn/image025_N.jpg" width="100%" /></p>

<p><img src="/images/pages/pf-vpn/image026_N.jpg" width="100%" /></p>

<p><strong>Little Request:</strong></p>

<blockquote>
  <p>I appreciate you guys taking the time in reading my post. Please check out my YouTube channel and please subscribe for more as it’ll help me loads.</p>
</blockquote>

<p><a href="https://www.youtube.com/channel/UCovlVsoRVItner26ZJPBjmQ/featured?view_as=subscriber" target="_blank">https://www.youtube.com/channel/UCovlVsoRVItner26ZJPBjmQ/featured?view_as=subscriber</a></p>

<p><a href="https://www.youtube.com/channel/UCovlVsoRVItner26ZJPBjmQ?sub_confirmation=1"><img src="Docker-Installation/sub.gif" /></a></p>

<p><a href="https://www.youtube.com/channel/UCovlVsoRVItner26ZJPBjmQ?sub_confirmation=1"><img src="Docker-Installation/sub.gif" alt="Foo" /></a></p>
:ET