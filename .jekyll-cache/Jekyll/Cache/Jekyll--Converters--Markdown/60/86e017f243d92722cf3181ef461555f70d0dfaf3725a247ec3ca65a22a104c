I"^2<style>.embed-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; } .embed-container iframe, .embed-container object, .embed-container embed { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }</style>
<div class="embed-container"><iframe src="https://www.youtube.com/embed/04_eZkoMviM/?&amp;autoplay=1" frameborder="0" allowfullscreen=""></iframe></div>

<h1 id="how-to-install-nagios-core-44-server-on-centosrhel-7">How to Install Nagios Core 4.4 Server on CentOS/RHEL 7</h1>

<h3 id="introduction">Introduction:</h3>
<p>Nagios is a industry slandered IT infrastructure monitoring solutions.
Which is one of the most popular, open source , powerful server and network monitoring system.
It enables organizations to identify and resolve IT infrastructure problems before they affect critical business processes. 
Nagios has the capability of monitoring application, services with an entire IT infrastructure.</p>

<p>Which can monitor host resources such as CPU Load,CPU Usage, DISK Throughput, Disk Iops, Network Speed, Network Throughput and finally trigger an alert via email.</p>

<h5 id="lab-setup">LAB SETUP</h5>

<table>
  <thead>
    <tr>
      <th>Host</th>
      <th>IP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Nagios 4 Server</td>
      <td>172.25.10.50</td>
    </tr>
    <tr>
      <td>Client</td>
      <td>172.25.10.100</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th>OS / Package</th>
      <th>Version</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>CentOS - Nagios Server</td>
      <td>7</td>
    </tr>
    <tr>
      <td>CentOS - Client Host</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Nagios Core</td>
      <td>4.4.5</td>
    </tr>
    <tr>
      <td>Nagios Plugin</td>
      <td>2.2.1</td>
    </tr>
    <tr>
      <td>NRPE Package</td>
      <td>3</td>
    </tr>
  </tbody>
</table>

<h1 id="server-side-configurations">SERVER SIDE CONFIGURATIONS</h1>

<h4 id="step-01-complete-prerequisites">STEP 01: Complete Prerequisites</h4>

<h5 id="a-selinux-configuration">A. SELinux Configuration:</h5>

<p>SELinux need to disabled &amp; set it into permissive mode.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'s/SELINUX=.*/SELINUX=disabled/g'</span> /etc/selinux/config
setenforce 0
</code></pre></div></div>

<p>Initially, We need to have a freshly installed CentOS7 / RHEL7 operating system.</p>

<h5 id="b-update-an-operating-system">B. Update an Operating System.</h5>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yum <span class="nt">-y</span> update
</code></pre></div></div>

<h5 id="c-install-required-packages">C. Install Required Packages.</h5>

<p>Now, We need to install Apache, PHP, SNMP and some other packages.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yum <span class="nb">install</span> <span class="nt">-y</span> gcc glibc glibc-common wget unzip httpd php gd gd-devel perl postfix net-snmp
</code></pre></div></div>

<h4 id="step-02-install-nagios-core">STEP 02: Install Nagios Core</h4>

<h5 id="a-download-nagios-core-source-package">A. Download Nagios Core Source Package.</h5>

<p>Create a download directory. And download Nagios Core version 4.4 into  that directory.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir</span> /nagios
<span class="nb">cd</span> /nagios

wget <span class="nt">-O</span> nagioscore.tar.gz https://github.com/NagiosEnterprises/nagioscore/archive/nagios-4.4.5.tar.gz
</code></pre></div></div>

<p>Extract nagios source package.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">tar </span>xvzf nagioscore.tar.gz
</code></pre></div></div>

<h5 id="b-compile-nagios-package">B. Compile Nagios Package.</h5>

<p>Configure Nagios settings.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> /nagios/nagioscore-nagios-4.4.5/

./configure
</code></pre></div></div>

<p><img src="/images/pages/nagios-install-centos7/1.png" width="100%" /></p>

<h5 id="c-compile-the-main-program--cgis">C. Compile the Main Program &amp; CGIs.</h5>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make all
</code></pre></div></div>

<p><img src="/images/pages/nagios-install-centos7/2.png" width="100%" /></p>

<h5 id="d-create-nagios-user--group">D. Create Nagios User &amp; Group.</h5>

<p>This adds the users and groups if they do not exist
This will creates a user and a group named “nagios”.
The apache user is also added to the nagios group.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make install-groups-users

usermod <span class="nt">-a</span> <span class="nt">-G</span> nagios apache
</code></pre></div></div>

<h5 id="e-install-the-main-program-cgis-and-html-files">E. Install the Main Program, CGIs and HTML files.</h5>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make <span class="nb">install</span>
</code></pre></div></div>

<h5 id="h-setup-services--daemons">H. Setup Services &amp; Daemons.</h5>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make install-init
</code></pre></div></div>

<h5 id="i-install-service--daemon">I. Install Service / Daemon</h5>
<p>This installs the service or daemon files and also configures them to start on boot.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make install-daemoninit
</code></pre></div></div>

<h5 id="j-set-permissions-on-the-external-commands-directory">J. Set Permissions on the External Commands Directory.</h5>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make install-commandmode
</code></pre></div></div>

<h5 id="k-install-sample-config-files">K. Install Sample Config Files.</h5>

<p>This installs <em>SAMPLE</em> config files in /usr/local/nagios/etc You’ll have to modify these sample files before you can use Nagios.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make install-config
</code></pre></div></div>

<h5 id="l-install-apache-configs-for-nagios-web-interface">L. Install Apache Configs For Nagios Web Interface.</h5>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make install-webconf
</code></pre></div></div>

<h5 id="m-install-nagios-interface-theme">M. Install Nagios Interface Theme.</h5>
<p>This installs the Exfoliation theme for the Nagios web interface.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make install-exfoliation
</code></pre></div></div>

<h5 id="m-firewall-configuration">M. Firewall Configuration.</h5>

<p>Allow inbound traffic via tcp port 80.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>firewall-cmd <span class="nt">--zone</span><span class="o">=</span>public <span class="nt">--add-port</span><span class="o">=</span>80/tcp <span class="nt">--permanent</span>
firewall-cmd <span class="nt">--reload</span>
</code></pre></div></div>

<h5 id="o-create-nagiosadmin-user-account">O. Create “nagiosadmin” User Account.</h5>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>htpasswd <span class="nt">-c</span> /usr/local/nagios/etc/htpasswd.users nagiosadmin
</code></pre></div></div>

<h5 id="p-start--enable-apache-web-server">P. Start &amp; Enable Apache Web Server.</h5>

<p>Enable service to start automatically  while system boot.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>systemctl start httpd.service
systemctl <span class="nb">enable </span>httpd.service
</code></pre></div></div>

<h5 id="q-enable--start-service">Q. Enable &amp; Start Service</h5>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>systemctl <span class="nb">enable </span>nagios.service 
systemctl restart nagios.service
</code></pre></div></div>

<h5 id="q-accessing-the-nagios-web-interface">Q. Accessing the Nagios Web Interface</h5>

<p>Now, Nagios Core server installation and configuration has been completed.</p>

<p>Now you can log into  the Nagios Web Interface through the web browser.</p>

<p>&lt;3.png&gt;
&lt;4.png&gt;</p>

<p>Note: You will notice there some error unders the hosts &amp; service,Eventhough We have installed Nagios Core.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">(</span>No output on stdout<span class="o">)</span> stderr: execvp<span class="o">(</span>/usr/local/nagios/libexec/check_load, ...<span class="o">)</span> failed. errno is 2: No such file or directory 
</code></pre></div></div>

<p>These errors wiil be resoloved once you installed nagios pluings.</p>

<h1 id="step-04-installing-nagios-plugins-from-yum-repository">STEP 04: Installing Nagios Plugins From YUM Repository</h1>

<p>A. Install Prerequisites</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yum <span class="nb">install</span> <span class="nt">-y</span> gcc glibc glibc-common make gettext automake autoconf wget openssl-devel net-snmp net-snmp-utils epel-release
yum <span class="nb">install</span> <span class="nt">-y</span> perl-Net-SNMP
</code></pre></div></div>
<p>B. Install Nagios Plugins</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yum <span class="nt">-y</span> <span class="nb">install </span>nagios-plugins-all
</code></pre></div></div>

<p>C. Copy plugins if not available in the directory.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cp</span> /usr/lib64/nagios/plugins/check_<span class="k">*</span> /usr/local/nagios/libexec/
</code></pre></div></div>

<h1 id="step-05-restart-nagios-apache-and-nrpe-servers">STEP 05: Restart Nagios, Apache and NRPE Servers</h1>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>systemctl restart nagios httpd nrpe
</code></pre></div></div>

<h1 id="step-06-how-to-install-nrpe-v3-from-yum-repository">STEP 06: How To Install NRPE v3 From YUM Repository</h1>

<p>A. Install Prerequisites</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yum <span class="nb">install</span> <span class="nt">-y</span> gcc glibc glibc-common openssl openssl-devel perl wget
</code></pre></div></div>

<p>B. Install Latest EPEL Repository And System Updates</p>

<p>Install Latest EPEL YUM Repository</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yum <span class="nt">-y</span> <span class="nb">install </span>https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yum <span class="nt">-y</span> update
</code></pre></div></div>

<p>C. Install (NRPE v3) Nagios Remote Plugin Executor</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yum <span class="nt">-y</span> <span class="nb">install </span>nrpe
</code></pre></div></div>

<p>D. Allow NRPE service Port Through the Firewall</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@nagios /]# firewall-cmd <span class="nt">--permanent</span> <span class="nt">--add-port</span><span class="o">=</span>5666/tcp
<span class="o">[</span>root@nagios /]# firewall-cmd <span class="nt">--reload</span>
</code></pre></div></div>

<p>F. Enable NRPE Service To Start at Boot</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>systemctl <span class="nb">enable </span>nrpe.service
systemctl restart nrpe.service
</code></pre></div></div>

<p><img src="/images/pages/nagios-install-centos7/3.png" width="100%" /></p>

<p><img src="/images/pages/nagios-install-centos7/4.png" width="100%" /></p>

<p><img src="/images/pages/nagios-install-centos7/5.png" width="100%" /></p>

<p><img src="/images/pages/nagios-install-centos7/6.png" width="100%" /></p>
:ET