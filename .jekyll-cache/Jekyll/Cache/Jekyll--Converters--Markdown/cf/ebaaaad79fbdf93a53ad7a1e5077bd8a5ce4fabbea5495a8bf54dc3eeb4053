I"E%<p><img src="elk-auditbeat/audit1.png" width="100%" /></p>

<style>.embed-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; } .embed-container iframe, .embed-container object, .embed-container embed { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }</style>
<div class="embed-container"><iframe src="https://www.youtube.com/embed/rWqUyGP_NwE" frameborder="0" allowfullscreen=""></iframe></div>

<h2 id="elk-stack-client-side-configuration-using-auditbeat">ELK Stack Client Side Configuration Using Auditbeat</h2>

<h2 id="introduction">Introduction:</h2>

<h4 id="beats-">Beats:-</h4>

<p>Beats is the platform for single purpose data shippers. 
Bests send data to Logstash or Elasticsearch.</p>

<p>All the Beats data ships to Elasticsearch or Logstash. And Visualize in Kibana.</p>

<h4 id="beat-types-">Beat Types:-</h4>

<p>There are number of types of Beats available according to your requirement.</p>

<p><strong>1. Filebeat</strong></p>

<p>You don’t need to dealing with thousands of server for log monitoring and analizing using using traditional SSH.</p>

<p>Filebeat forwarding all logs into centralized server.</p>

<p><strong>2. Auditbeat</strong></p>

<p>Lightweight shipper for Audit Data. 
You can keep eye on Linux Systems by monitoring user activities and processes and analyze even without toughing auditd daemon.
Auditbeat directly communicate with the Linux Audit Framework. 
So, You don’t need to install of configure auditd packages manually.</p>

<p><strong>3. Metricbeat</strong></p>

<p><strong>4. Pakcetbeat</strong></p>

<p><strong>5. Winlogbeat</strong></p>

<p><strong>6. Heatbeat</strong></p>

<p><strong>7. Functionbeat</strong></p>

<p>In this tutorial, I’m going to demonstrate Auditbeat only.</p>

<h4 id="install--configure-auditbeat">INSTALL &amp; CONFIGURE AUDITBEAT</h4>

<h5 id="step-01-install-auditbeat">STEP 01: INSTALL Auditbeat</h5>

<p>Download Relevant Package for your Operating System.
Install Auditbeat on all servers you want to monitor.</p>

<p>Ref: <a href="https://www.elastic.co/downloads/beats/filebeat" target="_blank">https://www.elastic.co/downloads/beats/filebeat</a></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-L</span> <span class="nt">-O</span> https://artifacts.elastic.co/downloads/beats/auditbeat/auditbeat-7.1.1-amd64.deb
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>dpkg <span class="nt">-i</span> auditbeat-7.1.1-amd64.deb
</code></pre></div></div>

<h5 id="step-02-configure-auditbeat">STEP 02: Configure Auditbeat</h5>

<p>Auditbeat main configuration file (auditbeat.yml) resides in directory (/etc/auditbeat/)</p>

<p>Ref: <a href="https://www.elastic.co/guide/en/beats/auditbeat/6.0/auditbeat-configuration.html" target="_blank">https://www.elastic.co/guide/en/beats/auditbeat/6.0/auditbeat-configuration.html</a></p>

<p><code class="language-plaintext highlighter-rouge">vim /etc/auditbeat/auditbeat.yml</code></p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#==========================  Modules configuration =============================</span>
<span class="s">auditbeat.modules</span><span class="pi">:</span>

<span class="pi">-</span> <span class="na">module</span><span class="pi">:</span> <span class="s">auditd</span>
  <span class="c1"># Load audit rules from separate files. Same format as audit.rules(7).</span>
  <span class="na">audit_rule_files</span><span class="pi">:</span> <span class="pi">[</span> <span class="s1">'</span><span class="s">${path.config}/audit.rules.d/*.conf'</span> <span class="pi">]</span>
  <span class="na">audit_rules</span><span class="pi">:</span> <span class="pi">|</span>

  <span class="s"># Add Custom Audit Rules According to Your Requirement</span>
     <span class="s">-a always,exclude -F msgtype=AVC</span>
     <span class="s">-a always,exclude -F msgtype=CWD</span>
     <span class="s">-a always,exclude -F msgtype=EOE</span>
     <span class="s">-a always,exclude -F msgtype=PROCTITLE</span>
     <span class="s">-a always,exclude -F msgtype=CRED_REFR</span>
     <span class="s">-a always,exclude -F msgtype=CRED_ACQ</span>
     <span class="s">-a always,exit -F arch=b64 -F dir=/DATA -S rmdir -S unlink -S unlinkat -S rename -S renameat -F uid=0 -k delete_data_root</span>
     <span class="s">-a always,exit -F arch=b64 -F dir=/DATA -S rmdir -S unlink -S unlinkat -S rename -S renameat -F uid&gt;=1000 -k delete_data_non_root</span>
     <span class="s">-a always,exit -F arch=b32 -F dir=/DATA -S rmdir -S unlink -S unlinkat -S rename -S renameat -F uid=0 -k delete_data_root</span>
     <span class="s">-a always,exit -F arch=b32 -F dir=/DATA -S rmdir -S unlink -S unlinkat -S rename -S renameat -F uid&gt;=1000 -k delete_data_non_root</span>

<span class="pi">-</span> <span class="na">module</span><span class="pi">:</span> <span class="s">file_integrity</span>
  <span class="c1"># Here You Can Add Custom Dorectories To Be Monitored</span>
  <span class="na">paths</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">/bin</span>
  <span class="pi">-</span> <span class="s">/usr/bin</span>
  <span class="pi">-</span> <span class="s">/sbin</span>
  <span class="pi">-</span> <span class="s">/usr/sbin</span>
  <span class="pi">-</span> <span class="s">/etc</span>

<span class="pi">-</span> <span class="na">module</span><span class="pi">:</span> <span class="s">system</span>
  <span class="na">datasets</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">host</span>    <span class="c1"># General host information, e.g. uptime, IPs</span>
    <span class="pi">-</span> <span class="s">login</span>   <span class="c1"># User logins, logouts, and system boots.</span>
    <span class="pi">-</span> <span class="s">package</span> <span class="c1"># Installed, updated, and removed packages</span>
    <span class="pi">-</span> <span class="s">process</span> <span class="c1"># Started and stopped processes</span>
    <span class="pi">-</span> <span class="s">socket</span>  <span class="c1"># Opened and closed sockets</span>
    <span class="pi">-</span> <span class="s">user</span>    <span class="c1"># User information</span>

  <span class="s">state.period</span><span class="pi">:</span> <span class="s">12h</span>
  <span class="s">user.detect_password_changes</span><span class="pi">:</span> <span class="no">true</span>

  <span class="c1"># File patterns of the login record files.</span>
  <span class="s">login.wtmp_file_pattern</span><span class="pi">:</span> <span class="s">/var/log/wtmp*</span>
  <span class="s">login.btmp_file_pattern</span><span class="pi">:</span> <span class="s">/var/log/btmp*</span>

<span class="c1">#==================== Elasticsearch template setting ==========================</span>
<span class="s">setup.template.settings</span><span class="pi">:</span>
  <span class="s">index.number_of_shards</span><span class="pi">:</span> <span class="m">1</span>

<span class="c1">#============================== Kibana =====================================</span>
<span class="s">setup.kibana</span><span class="pi">:</span>

<span class="c1"># Comment If not using "elasticsearch output" section</span>

<span class="c1">#----------------------------- Logstash output --------------------------------</span>
<span class="s">output.logstash</span><span class="pi">:</span>
  <span class="c1"># The Logstash hosts</span>
  <span class="na">hosts</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">192.168.0.248:5044"</span><span class="pi">]</span>

<span class="c1">#================================ Processors =====================================</span>

<span class="na">processors</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">add_host_metadata</span><span class="pi">:</span> <span class="s">~</span>
  <span class="pi">-</span> <span class="na">add_cloud_metadata</span><span class="pi">:</span> <span class="s">~</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Start &amp; Enable at system boot:
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>systemctl <span class="nb">enable </span>auditbeat.service
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>systemctl start auditbeat.service
</code></pre></div></div>

<p>REF: <a href="https://www.elastic.co/downloads/beats/filebeat" target="_blank">https://www.elastic.co/downloads/beats/filebeat</a></p>

<table>
  <tbody>
    <tr>
      <td>**Note: You also can define any compatible auditd rules according to your requirement. You have to include audit rules under the “ audit_rules:</td>
      <td>” section of auditbeat.yml file or “/etc/auditbeat/audit.rules.d/” directory.**</td>
    </tr>
  </tbody>
</table>

<p><a href="https://www.youtube.com/channel/UCovlVsoRVItner26ZJPBjmQ?sub_confirmation=1"><img src="Docker-Installation/sub.gif" /></a></p>

<p><a href="https://www.youtube.com/channel/UCovlVsoRVItner26ZJPBjmQ?sub_confirmation=1"><img src="Docker-Installation/sub.gif" alt="Foo" /></a></p>
:ET